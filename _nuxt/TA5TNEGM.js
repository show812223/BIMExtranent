import{N as $,O as K,P as E,r as k,Q as N,z as t,c as m,R as G,S as se,T as Q,U as Z,V as ye,W as be,X as xe,Y as Ve,Z as he,H as ie,$ as Ce,a0 as q,a1 as z,a2 as _e,a3 as ke,a4 as pe,a5 as Ie,a6 as Se,a7 as Pe,a8 as ee,a9 as Fe,d as Re,aa as we,ab as Be,ac as Te,ad as Le,o as Me,ae as Ae,L as De,A as B,t as $e,af as te,ag as ae,x as re,y as Ee,B as Ne,ah as Ue,ai as Oe,C as We,D as je,_ as qe}from"./CDMwRna9.js";import{u as ze}from"./CGWdrzfI.js";import{m as Ke,M as He,u as Xe,a as Ye,V as le}from"./Dxkh4y_u.js";import{m as Qe,c as Ze,V as Ge,a as Je,b as et,d as tt,u as at,e as ue,f as lt,L as nt,g as ot,h as st,i as ne,j as it,k as rt,l as ut,n as dt}from"./DGpfm_ih.js";import{f as de,n as ct,a as ft,s as vt,V as mt}from"./BUuIBmwz.js";import{m as gt,u as yt,I as bt}from"./BxtRHTqe.js";import"./sj1_xYdN.js";const xt=$({...K(),...Qe()},"VForm"),Vt=E()({name:"VForm",props:xt(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,r){let{slots:s,emit:V}=r;const a=Ze(e),c=k();function y(u){u.preventDefault(),a.reset()}function F(u){const f=u,n=a.validate();f.then=n.then.bind(n),f.catch=n.catch.bind(n),f.finally=n.finally.bind(n),V("submit",f),f.defaultPrevented||n.then(p=>{var h;let{valid:w}=p;w&&((h=c.value)==null||h.submit())}),f.preventDefault()}return N(()=>{var u;return t("form",{ref:c,class:["v-form",e.class],style:e.style,novalidate:!0,onReset:y,onSubmit:F},[(u=s.default)==null?void 0:u.call(s,a)])}),de(a,c)}}),ht=$({active:Boolean,max:[Number,String],value:{type:[Number,String],default:0},...K(),...Ke({transition:{component:Ge}})},"VCounter"),Ct=E()({name:"VCounter",functional:!0,props:ht(),setup(e,r){let{slots:s}=r;const V=m(()=>e.max?`${e.value} / ${e.max}`:String(e.value));return N(()=>t(He,{transition:e.transition},{default:()=>[G(t("div",{class:["v-counter",e.class],style:e.style},[s.default?s.default({counter:V.value,max:e.max,value:e.value}):V.value]),[[se,e.active]])]})),{}}}),_t=$({floating:Boolean,...K()},"VFieldLabel"),j=E()({name:"VFieldLabel",props:_t(),setup(e,r){let{slots:s}=r;return N(()=>t(Je,{class:["v-field-label",{"v-field-label--floating":e.floating},e.class],style:e.style,"aria-hidden":e.floating||void 0},s)),{}}}),kt=["underlined","outlined","filled","solo","solo-inverted","solo-filled","plain"],ce=$({appendInnerIcon:Q,bgColor:String,clearable:Boolean,clearIcon:{type:Q,default:"$clear"},active:Boolean,centerAffix:{type:Boolean,default:void 0},color:String,baseColor:String,dirty:Boolean,disabled:{type:Boolean,default:null},error:Boolean,flat:Boolean,label:String,persistentClear:Boolean,prependInnerIcon:Q,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:e=>kt.includes(e)},"onClick:clear":Z(),"onClick:appendInner":Z(),"onClick:prependInner":Z(),...K(),...et(),...gt(),...ye()},"VField"),fe=E()({name:"VField",inheritAttrs:!1,props:{id:String,...tt(),...ce()},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,r){let{attrs:s,emit:V,slots:a}=r;const{themeClasses:c}=be(e),{loaderClasses:y}=at(e),{focusClasses:F,isFocused:u,focus:f,blur:n}=ue(e),{InputIcon:p}=lt(e),{roundedClasses:w}=yt(e),{rtlClasses:h}=xe(),i=m(()=>e.dirty||e.active),l=m(()=>!e.singleLine&&!!(e.label||a.label)),v=Ve(),d=m(()=>e.id||`input-${v}`),H=m(()=>`${d.value}-messages`),U=k(),T=k(),O=k(),o=m(()=>["plain","underlined"].includes(e.variant)),{backgroundColorClasses:C,backgroundColorStyles:_}=Xe(he(e,"bgColor")),{textColorClasses:I,textColorStyles:X}=Ye(m(()=>e.error||e.disabled?void 0:i.value&&u.value?e.color:e.baseColor));ie(i,b=>{if(l.value){const g=U.value.$el,S=T.value.$el;requestAnimationFrame(()=>{const P=ct(g),x=S.getBoundingClientRect(),M=x.x-P.x,A=x.y-P.y-(P.height/2-x.height/2),R=x.width/.75,D=Math.abs(R-P.width)>1?{maxWidth:Ce(R)}:void 0,W=getComputedStyle(g),J=getComputedStyle(S),ve=parseFloat(W.transitionDuration)*1e3||150,me=parseFloat(J.getPropertyValue("--v-field-label-scale")),ge=J.getPropertyValue("color");g.style.visibility="visible",S.style.visibility="hidden",ft(g,{transform:`translate(${M}px, ${A}px) scale(${me})`,color:ge,...D},{duration:ve,easing:vt,direction:b?"normal":"reverse"}).finished.then(()=>{g.style.removeProperty("visibility"),S.style.removeProperty("visibility")})})}},{flush:"post"});const L=m(()=>({isActive:i,isFocused:u,controlRef:O,blur:n,focus:f}));function Y(b){b.target!==document.activeElement&&b.preventDefault()}return N(()=>{var M,A,R;const b=e.variant==="outlined",g=!!(a["prepend-inner"]||e.prependInnerIcon),S=!!(e.clearable||a.clear),P=!!(a["append-inner"]||e.appendInnerIcon||S),x=()=>a.label?a.label({...L.value,label:e.label,props:{for:d.value}}):e.label;return t("div",z({class:["v-field",{"v-field--active":i.value,"v-field--appended":P,"v-field--center-affix":e.centerAffix??!o.value,"v-field--disabled":e.disabled,"v-field--dirty":e.dirty,"v-field--error":e.error,"v-field--flat":e.flat,"v-field--has-background":!!e.bgColor,"v-field--persistent-clear":e.persistentClear,"v-field--prepended":g,"v-field--reverse":e.reverse,"v-field--single-line":e.singleLine,"v-field--no-label":!x(),[`v-field--variant-${e.variant}`]:!0},c.value,C.value,F.value,y.value,w.value,h.value,e.class],style:[_.value,e.style],onClick:Y},s),[t("div",{class:"v-field__overlay"},null),t(nt,{name:"v-field",active:!!e.loading,color:e.error?"error":typeof e.loading=="string"?e.loading:e.color},{default:a.loader}),g&&t("div",{key:"prepend",class:"v-field__prepend-inner"},[e.prependInnerIcon&&t(p,{key:"prepend-icon",name:"prependInner"},null),(M=a["prepend-inner"])==null?void 0:M.call(a,L.value)]),t("div",{class:"v-field__field","data-no-activator":""},[["filled","solo","solo-inverted","solo-filled"].includes(e.variant)&&l.value&&t(j,{key:"floating-label",ref:T,class:[I.value],floating:!0,for:d.value,style:X.value},{default:()=>[x()]}),t(j,{ref:U,for:d.value},{default:()=>[x()]}),(A=a.default)==null?void 0:A.call(a,{...L.value,props:{id:d.value,class:"v-field__input","aria-describedby":H.value},focus:f,blur:n})]),S&&t(ot,{key:"clear"},{default:()=>[G(t("div",{class:"v-field__clearable",onMousedown:D=>{D.preventDefault(),D.stopPropagation()}},[a.clear?a.clear():t(p,{name:"clear"},null)]),[[se,e.dirty]])]}),P&&t("div",{key:"append",class:"v-field__append-inner"},[(R=a["append-inner"])==null?void 0:R.call(a,L.value),e.appendInnerIcon&&t(p,{key:"append-icon",name:"appendInner"},null)]),t("div",{class:["v-field__outline",I.value],style:X.value},[b&&t(q,null,[t("div",{class:"v-field__outline__start"},null),l.value&&t("div",{class:"v-field__outline__notch"},[t(j,{ref:T,floating:!0,for:d.value},{default:()=>[x()]})]),t("div",{class:"v-field__outline__end"},null)]),o.value&&l.value&&t(j,{ref:T,floating:!0,for:d.value},{default:()=>[x()]})])])}),{controlRef:O}}});function pt(e){const r=Object.keys(fe.props).filter(s=>!_e(s)&&s!=="class"&&s!=="style");return ke(e,r)}const It=["color","file","time","date","datetime-local","week","month"],St=$({autofocus:Boolean,counter:[Boolean,Number,String],counterValue:[Number,Function],prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,role:String,type:{type:String,default:"text"},modelModifiers:Object,...st(),...ce()},"VTextField"),oe=E()({name:"VTextField",directives:{Intersect:bt},inheritAttrs:!1,props:St(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,r){let{attrs:s,emit:V,slots:a}=r;const c=pe(e,"modelValue"),{isFocused:y,focus:F,blur:u}=ue(e),f=m(()=>typeof e.counterValue=="function"?e.counterValue(c.value):typeof e.counterValue=="number"?e.counterValue:(c.value??"").toString().length),n=m(()=>{if(s.maxlength)return s.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter}),p=m(()=>["plain","underlined"].includes(e.variant));function w(o,C){var _,I;!e.autofocus||!o||(I=(_=C[0].target)==null?void 0:_.focus)==null||I.call(_)}const h=k(),i=k(),l=k(),v=m(()=>It.includes(e.type)||e.persistentPlaceholder||y.value||e.active);function d(){var o;l.value!==document.activeElement&&((o=l.value)==null||o.focus()),y.value||F()}function H(o){V("mousedown:control",o),o.target!==l.value&&(d(),o.preventDefault())}function U(o){d(),V("click:control",o)}function T(o){o.stopPropagation(),d(),ee(()=>{c.value=null,Fe(e["onClick:clear"],o)})}function O(o){var _;const C=o.target;if(c.value=C.value,(_=e.modelModifiers)!=null&&_.trim&&["text","search","password","tel","url"].includes(e.type)){const I=[C.selectionStart,C.selectionEnd];ee(()=>{C.selectionStart=I[0],C.selectionEnd=I[1]})}}return N(()=>{const o=!!(a.counter||e.counter!==!1&&e.counter!=null),C=!!(o||a.details),[_,I]=Ie(s),{modelValue:X,...L}=ne.filterProps(e),Y=pt(e);return t(ne,z({ref:h,modelValue:c.value,"onUpdate:modelValue":b=>c.value=b,class:["v-text-field",{"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-input--plain-underlined":p.value},e.class],style:e.style},_,L,{centerAffix:!p.value,focused:y.value}),{...a,default:b=>{let{id:g,isDisabled:S,isDirty:P,isReadonly:x,isValid:M}=b;return t(fe,z({ref:i,onMousedown:H,onClick:U,"onClick:clear":T,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:e.role},Y,{id:g.value,active:v.value||P.value,dirty:P.value||e.dirty,disabled:S.value,focused:y.value,error:M.value===!1}),{...a,default:A=>{let{props:{class:R,...D}}=A;const W=G(t("input",z({ref:l,value:c.value,onInput:O,autofocus:e.autofocus,readonly:x.value,disabled:S.value,name:e.name,placeholder:e.placeholder,size:1,type:e.type,onFocus:d,onBlur:u},D,I),null),[[Se("intersect"),{handler:w},null,{once:!0}]]);return t(q,null,[e.prefix&&t("span",{class:"v-text-field__prefix"},[t("span",{class:"v-text-field__prefix__text"},[e.prefix])]),a.default?t("div",{class:R,"data-no-activator":""},[a.default(),W]):Pe(W,{class:R}),e.suffix&&t("span",{class:"v-text-field__suffix"},[t("span",{class:"v-text-field__suffix__text"},[e.suffix])])])}})},details:C?b=>{var g;return t(q,null,[(g=a.details)==null?void 0:g.call(a,b),o&&t(q,null,[t("span",null,null),t(Ct,{active:e.persistentCounter||y.value,value:f.value,max:n.value},a.counter)])])}:void 0})}),de({},h,i,l)}}),Pt=e=>(We("data-v-722b6bba"),e=e(),je(),e),Ft=Pt(()=>re("div",{class:"font-red"}," 請使用開機帳號密碼 ",-1)),Rt={class:"text-body-1 font-red"},wt=Re({__name:"login",setup(e){we(i=>({f07b8a2c:F.value}));const r=Be(),s=Te(),V=ze(),a=[i=>i&&i.length>0?!0:"請輸入帳號"],c=[i=>i&&i.length>0?!0:"請輸入密碼"],y=k(),F=k("350px"),u=k(!1),f=k(""),n=Le({account:"",password:"",isRemember:!0}),p=m(()=>V.getIsMobile),w=m(()=>V.getScreenWidth);ie(w,i=>{p.value?F.value=`${i*.8}px`:F.value="350px"}),Me(()=>{if(Ae("Token")){const l=r.currentRoute.value.query.redirect;l&&r.push(l.toString())}});const h=async()=>{const{valid:i}=await y.value.validate();if(!i)return;u.value=!0;const l=await Ue.authenticate.getAuthenticate(n.account,n.password);if(l.isSuccess){const v={token:l.token,expiresIn:l.expiresIn};await s.updateToken(v,n.isRemember).catch(()=>{f.value="發生錯誤",u.value=!1});let d=r.currentRoute.value.query.redirect;d||(d="/"),r.push(d.toLocaleString())}else{n.password="";const v=Oe[l.message];f.value=v||"發生錯誤",u.value=!1}};return(i,l)=>($e(),De(le,{class:"ma-0 all-height",align:"center",justify:"center"},{default:B(()=>[t(dt,{class:"login-card",title:"系統登入"},{default:B(()=>[t(it,{"fast-fail":"",onSubmit:l[0]||(l[0]=te(()=>{},["prevent"]))},{default:B(()=>[Ft]),_:1}),t(Vt,{class:"ma-4",ref_key:"formInstRef",ref:y,onSubmit:l[4]||(l[4]=te(()=>{},["prevent"]))},{default:B(()=>[t(oe,{modelValue:n.account,"onUpdate:modelValue":l[1]||(l[1]=v=>n.account=v),rules:a,label:"帳號",onKeyup:ae(h,["enter"])},null,8,["modelValue"]),t(oe,{modelValue:n.password,"onUpdate:modelValue":l[2]||(l[2]=v=>n.password=v),rules:c,type:"password",label:"密碼",onKeyup:ae(h,["enter"])},null,8,["modelValue"]),t(rt,{modelValue:n.isRemember,"onUpdate:modelValue":l[3]||(l[3]=v=>n.isRemember=v),label:"記住我"},null,8,["modelValue"]),t(le,{class:"mb-4 mr-2",justify:"end"},{default:B(()=>[re("div",Rt,Ee(f.value),1),t(ut,{color:"success",loading:u.value,onClick:h},{loader:B(()=>[t(mt,{color:"green",size:30,indeterminate:""})]),default:B(()=>[Ne(" 登入 ")]),_:1},8,["loading"])]),_:1})]),_:1},512)]),_:1})]),_:1}))}}),Et=qe(wt,[["__scopeId","data-v-722b6bba"]]);export{Et as default};
